@model List<FaceDetails>
@{
    ViewData["Title"] = "Home Page";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>WebcamJS Test Page</title>
    <link href="~/lib/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
    <style type="text/css">
        body {
            font-family: Helvetica, sans-serif;
        }

        h2, h3 {
            margin-top: 0;
        }

        form {
            margin-top: 15px;
        }

            form > input {
                margin-right: 15px;
            }

        #buttonhide {
            background: transparent;
            border: none !important;
            font-size: 0;
        }
    </style>
</head>
<body class="container">
    <br />
    <h1 class="text-center">Make Me Laugh</h1>
    <div class="col-md-2"></div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">Camera</div>
            <div class="panel-body">
                <div id="my_camera"></div>
                <!-- A button for taking snaps -->
                <div align="center">
                    
                    <h2>Capture images</h2>

                    <audio controls autoplay>
                        <source src="sample.mp3" type="audio/mpeg">
                    </audio>

                    @if (@Model != null)
                    {
                        @foreach (var face in @Model)
                        {
                            <img src="@face.ImagePath">
                            @*<div>Anger: @face.Anger</div>*@
                            <div>Laughing? @face.Joy</div>
                            @*<div>Sorrow: @face.Sorrow</div>
                <div>Surprise: @face.Surprise</div>*@
                        }
                    }
                </div>
                <form>
                    <input type="button" class="btn btn-success" value="Take Snapshot" onClick="take_snapshot()">
                </form>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">Captured Photo</div>
            <div class="panel-body">
                <div id="results">Your captured image will appear here...</div>
            </div>
            <br />
            <br />
        </div>
    </div>
    <div class="col-md-2">    </div>
    <!-- First, include the Webcam.js JavaScript Library -->
    <script src="~/webcamjs/webcam.js"></script>
    <!-- Configure a few settings and attach camera -->
    <script language="JavaScript">
        Webcam.set({
            width: 320,
            height: 240,
            image_format: 'jpeg',
            jpeg_quality: 90
        });
        Webcam.attach('#my_camera');
    </script>
    <!-- Code to handle taking the snapshot and displaying it locally -->
    <script language="JavaScript">

        //window.onload = function () {
        //    setInterval(function () { take_snapshot(onclick) }, 1000),
        //        clearInterval(function () { take_snapshot() }, 5000);
        //}
        var cameraInterval = setInterval(take_snapshot, 1000);
        setTimeout(() => { clearInterval(cameraInterval) }, 30000);

        function take_snapshot() {
            // take snapshot and get image data
            Webcam.snap(function (data_uri) {
                // display results in page
                document.getElementById('results').innerHTML =
                    '<img src="' + data_uri + '"/>';
                Webcam.upload(data_uri, '/Camera/Capture');

            });
        }

        //function stopCamera() {
        //    clearInterval(cameraInterval)
        //}

        //Boolean cameraOn = true;
        //var timeoutInSeconds = 30000;

        //while (cameraOn) {

        //    window.onclick = function () {
        //    setInterval(function () { take_snapshot(time) }, 1000);
                
        //        }
        //    function take_snapshot() {
        //    // take snapshot and get image data
        //    Webcam.snap(function (data_uri) {
        //    // display results in page
        //        document.getElementById('results').innerHTML =
        //            '<img id="base64image" src="' + data_uri + '"/>';
        //        Webcam.upload(data_uri, '/Camera/Capture' );
        //         });
        //    }

        //    function checkTime(i) {
        //    if (i<10) {
        //    i = "0" + i;
        //    }
        //    return i;
        //}
        
    </script>
</body>
</html>

